<div id="genericModalDiv">

  <!--RESULT DISPLAY DIV BEGIN-->
  <div id="resultDIV" data-bind="visible: hasResult,css: styleClass" class="alert fresh-color">
    <strong>
      <span data-bind="text:resultTitle"></span>
    </strong>
    <span data-bind="text:resultSubTitle"></span>
    <div data-bind="text:resultContent"></div>
  </div>
  <!--RESULT DISPLAY DIV END-->

  <!--CONTENT DIV BEGIN-->
  <div id="modal_content_div">
    <div class="card card-success">
      <div class="card profile">
        <div class="card-body">
          <!--Validation DIV BEGIN-->
          <div data-bind="visible: hasError" class="alert alert-warning alert-dismissible fresh-color" role="alert">
            <button type="button" data-bind="click:function(){hasError(!hasError)}" class="close" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <strong>Warning!</strong>
            <div id="errorMessagesDIV" data-bind="foreach:errorMessage">
              <div data-bind="text:$data"></div>
            </div>
          </div>
          <!--Validation DIV END-->
          <!-- *******YOUR SHOULD CODING IN HERE:[BEGIN]*******-->
          <div data-bind="if:businessPOJO()">


            <div class="step">
              <ul class="nav nav-tabs nav-justified" role="tablist">
                <li role="step" class="active">
                  <a href="#step1" id="step1-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">
                    <div class="icon fa fa-database"></div>
                    <div class="step-title">
                      <div class="title">Step 1</div>
                      <div class="description">Data Source Setting</div>
                    </div>
                  </a>
                </li>
                <li role="step">
                  <a href="#step2" role="tab" id="step2-tab" data-toggle="tab" aria-controls="profile">
                    <div class="icon fa fa-stethoscope"></div>
                    <div class="step-title">
                      <div class="title">Step 2</div>
                      <div class="description">Filter Condition Setting </div>
                    </div>
                  </a>
                </li>
                <li role="step">
                  <a href="#step2" role="tab" id="step2-tab" data-toggle="tab" aria-controls="profile">
                    <div class="icon fa fa-edit"></div>
                    <div class="step-title">
                      <div class="title">Step 3</div>
                      <div class="description">Analyzing Result Setting </div>
                    </div>
                  </a>
                </li>
                <li role="step">
                  <a href="#step2" role="tab" id="step2-tab" data-toggle="tab" aria-controls="profile">
                    <div class="icon fa fa-checkered"></div>
                    <div class="step-title">
                      <div class="title">Step 4</div>
                      <div class="description">Script Generation </div>
                    </div>
                  </a>
                </li>
              </ul>

              <div class="tab-content" data-bind="if:businessPOJO()">
                <div role="tabpanel" class="tab-pane fade in active" id="step1" aria-labelledby="home-tab">
                  <div class="card card-info">
                    <div class="card-header">
                      <div class="card-title">
                        <div class="title"><i class="fa fa-cogs"></i> Data Source Setting
                        </div>
                      </div>
                    </div>
                    <div class="card profile">
                      <div class="card-body">

                        <div class="panel fresh-color panel-primary">
                          <div class="panel-heading">Time Scope Editing Panel</div>
                          <div class="panel-body">
                            <form class="form-inline" >
                              <label class="col-sm-1 control-label">Atomic:</label>
                              <div class="col-sm-11">
                                <label> Atomic_Name </label>
                              </div>
                            </form>
                            <form class="form-inline">
                              <div class="col-sm-12">
                                <label>Date:</label>
                                <div class="input-group date form_date " data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                  <input class="form-control" size="16" type="text" id="searchBegin" value="" readonly>
                                  <span class="input-group-addon">
                                          <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                                </div>
                                <label> &nbsp;to&nbsp; </label>
                                <div class="input-group date form_date " data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                  <input class="form-control" size="16" type="text" id="searchEnd" value="" readonly>
                                  <span class="input-group-addon">
                                          <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                                </div>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label>Time:</label>
                                <div class="form-group">
                                  <input type="tel" class="form-control hour" id="fromHour" placeholder="0" style="width:40px">
                                </div>
                                <label> &nbsp;to&nbsp; </label>
                                <div class="form-group">
                                  <input type="tel" class="form-control hour" id="toHour" placeholder="24" style="width:40px">
                                </div>
                                <button type="button" class="btn btn-link" title="Add" onclick="">
                                  <div class="title"><i class="fa fa-check fa-2x"></i></div>
                                </button>
                              </div>
                            </form>
                          </div>
                        </div>
                        <div>
                          <form class="form-horizontal">
                            <div class="form-group">
                              <label for="DBName" class="col-sm-2 control-label">Metadata List</label>
                              <div class="col-sm-10">
                                <select data-bind="options: businessPOJO().availableMetadatas,
                                  optionsText: function(item) {return '12345'},
                                  value: businessPOJO().selectedMetadata,
                                  optionsCaption: 'Choose...'" class="form-control" style="width:360px">
                                </select>
                              </div>
                              <div class="col-sm-10 col-sm-offset-2" style="padding-top:6px">
                                <div class="alert alert-warning fresh-color" role="alert" style="margin-bottom: -26px;">Warning: Edit metadata information first when no satisfied item from the available list.</div>
                              </div>
                            </div>
                          </form>
                        </div>
                        <br>
                        <div class="row" data-bind="visible: true">
                          <div class="col-md-12">
                            <div class="card blue summary-inline">
                              <div class="card-body">
                                <i class="icon fa fa-info-circle fa-1x"> &nbsp;<strong>Information</strong></i>
                              </div>
                              <div class="row text-center" style="font-size:28px">
                                <div class="col-md-12">
                                  <i class="fa fa-bullhorn fa-1x"></i> <span id="infoMessage">Currently no metadata selected, please select one first ...</span>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="panel fresh-color panel-info">
                          <div class="panel-heading">Metadata Mapped Hive Table List</div>
                          <div class="panel-body">
                            <div class="row">
                              <div class="col-md-12" style="overflow: auto">
                                <form class="navbar-form navbar-right" role="search">
                                  <div class="form-group">
                                    <input data-bind="value:genericModalViewModel.businessPOJO().tables.searchKeyword" class="form-control" placeholder="输入关键字" type="text">
                                  </div>
                                  <button data-bind="click:function(){genericModalViewModel.businessPOJO().tables.buildView()}" type="submit" class="btn btn-info">搜索</button>
                                </form>
                                <table class="table table-striped sortable" cellspacing="0" width="100%">
                                  <thead>
                                    <tr>
                                      <th>select</th>
                                      <th>table</th>
                                      <th>metadata </th>
                                    </tr>
                                  </thead>
                                  <tbody data-bind="foreach: genericModalViewModel.businessPOJO().tables.viewData">
                                    <!-- <tr data-bind="visible:isDisplay,foreach: data">
                                      <td data-bind="text: $data"></td>
                                    </tr> -->
                                    <tr>
                                      <td>
                                        <input type="checkbox" data-bind="checked: isChecked" />
                                      </td>
                                      <td data-bind="text: data[1]"></td>
                                      <td data-bind="text: data[2]"></td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <div id="pagingDIV">
                              <nav>
                                <ul class="pager">
                                  <span class="pull-left">Total Size:
                                        <span data-bind="text:genericModalViewModel.businessPOJO().tables.totalCounts()"></span>
                                  </span>
                                  <span class="pull-right">
                                        <select class="form-control" style="width:88px" data-bind="options:genericModalViewModel.businessPOJO().tables.pagingSizeArray,value:genericModalViewModel.businessPOJO().tables.pageMaxSize"></select>
                                      </span>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().tables.toPage(1)}" href="#">首页</a></li>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().tables.toPage(genericModalViewModel.businessPOJO().tables.currentPageNumber()-1)}" href="#">前翻</a></li>
                                  <li>
                                    <input data-bind="value:genericModalViewModel.businessPOJO().tables.currentPageNumber" style="width:38px" ;type="text" class="text-center">
                                  </li>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().tables.toPage(genericModalViewModel.businessPOJO().tables.currentPageNumber()+1)}" href="#">后翻</a></li>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().tables.toPage(genericModalViewModel.businessPOJO().tables.totalPage())}" href="#">末页</a></li>
                                </ul>
                              </nav>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
                <div role="tabpanel" class="tab-pane fade" id="step2" aria-labelledby="profile-tab">
                  <div class="card card-info">
                    <div class="card-header">
                      <div class="card-title">
                        <div class="title"><i class="fa fa-cogs"></i> Filter Condition Setting </div>
                      </div>
                      <div class="pull-right card-action">
                        <div class="btn-group" role="group" aria-label="..." id="hideFilesDIV">
                          <button type="button" class="btn btn-link" title="隐藏" onclick="$('#atomicsContentDIV').css('display', 'none'),$('#displayFilesDIV').css('display', ''),$('#hideFilesDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-up fa-2x"></i></div>
                          </button>
                        </div>
                        <div class="btn-group" role="group" aria-label="..." id="displayFilesDIV" style="display:none">
                          <button type="button" class="btn btn-link" title="显示" onclick="$('#atomicsContentDIV').css('display', ''),$('#hideFilesDIV').css('display', ''),$('#displayFilesDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-down fa-2x"></i></div>
                          </button>
                        </div>
                      </div>
                    </div>

                    <div class="card profile" id="atomicsContentDIV">
                      <div class="card-body">


                        <div class="panel fresh-color panel-info">
                          <div class="panel-heading">Metadata Atomics List</div>
                          <div class="panel-body">
                            <div class="row">
                              <div class="col-md-12" style="overflow: auto">
                                <form class="navbar-form navbar-right" role="search">
                                  <div class="form-group">
                                    <input data-bind="value:genericModalViewModel.businessPOJO().atomics.searchKeyword" class="form-control" placeholder="输入关键字" type="text">
                                  </div>
                                  <button data-bind="click:function(){genericModalViewModel.businessPOJO().atomics.buildView()}" type="submit" class="btn btn-info">搜索</button>
                                </form>
                                <table class="table table-striped sortable" cellspacing="0" width="100%">
                                  <thead>
                                    <tr>
                                      <th>table</th>
                                      <th>metadata </th>
                                      <th>action</th>
                                    </tr>
                                  </thead>
                                  <tbody data-bind="foreach: genericModalViewModel.businessPOJO().atomics.viewData">
                                    <tr>
                                      <td data-bind="text: data[1]"></td>
                                      <td data-bind="text: data[2]"></td>
                                      <td>
                                        <button type="button" class="btn btn-link" title="As Time Scope" data-bind="click:(function(){})" style="margin:-6px -6px -6px -6px">
                                          <div class="title"><i class="fa fa-calendar fa-1x"></i></div>
                                        </button>
                                        <button type="button" class="btn btn-link" title="As Business Condition" data-bind="click:(function(){})" style="margin:-6px -6px -6px -6px">
                                          <div class="title"><i class="fa fa-filter fa-1x"></i></div>
                                        </button>
                                        <button type="button" class="btn btn-link" title="As Noise" data-bind="click:(function(){})" style="margin:-6px -6px -6px -6px">
                                          <div class="title"><i class="fa fa-eraser fa-1x"></i></div>
                                        </button>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <div id="pagingDIV">
                              <nav>
                                <ul class="pager">
                                  <span class="pull-left">Total Size:
                                        <span data-bind="text:genericModalViewModel.businessPOJO().atomics.totalCounts()"></span>
                                  </span>
                                  <span class="pull-right">
                                        <select class="form-control" style="width:88px" data-bind="options:genericModalViewModel.businessPOJO().atomics.pagingSizeArray,value:genericModalViewModel.businessPOJO().atomics.pageMaxSize"></select>
                                      </span>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().atomics.toPage(1)}" href="#">首页</a></li>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().atomics.toPage(genericModalViewModel.businessPOJO().atomics.currentPageNumber()-1)}" href="#">前翻</a></li>
                                  <li>
                                    <input data-bind="value:genericModalViewModel.businessPOJO().atomics.currentPageNumber" style="width:38px" ;type="text" class="text-center">
                                  </li>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().atomics.toPage(genericModalViewModel.businessPOJO().atomics.currentPageNumber()+1)}" href="#">后翻</a></li>
                                  <li><a data-bind="click:function(){genericModalViewModel.businessPOJO().atomics.toPage(genericModalViewModel.businessPOJO().atomics.totalPage())}" href="#">末页</a></li>
                                </ul>
                              </nav>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>

                  <div class="card card-info">
                    <div class="card-header">
                      <div class="card-title">
                        <div class="title"><i class="fa fa-cogs"></i> Time Scope Editing </div>
                      </div>
                      <div class="pull-right card-action">
                        <div class="btn-group" role="group" aria-label="..." id="hideAtomicsTimeDIV" style="display:none">
                          <button type="button" class="btn btn-link" title="隐藏" onclick="$('#atomicsTimeContentDIV').css('display', 'none'),$('#displayAtomicsTimeDIV').css('display', ''),$('#hideAtomicsTimeDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-up fa-2x"></i></div>
                          </button>
                        </div>
                        <div class="btn-group" role="group" aria-label="..." id="displayAtomicsTimeDIV">
                          <button type="button" class="btn btn-link" title="显示" onclick="$('#atomicsTimeContentDIV').css('display', ''),$('#hideAtomicsTimeDIV').css('display', ''),$('#displayAtomicsTimeDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-down fa-2x"></i></div>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="card profile" id="atomicsTimeContentDIV" style="display:none">
                      <div class="card-body">
                        <div class="panel fresh-color panel-primary">
                          <div class="panel-heading">Time Scope Editing Panel</div>
                          <div class="panel-body">
                            <form class="form-inline" >
                              <label class="col-sm-1 control-label">Atomic:</label>
                              <div class="col-sm-11">
                                <label> Atomic_Name </label>
                              </div>
                            </form>
                            <form class="form-inline">
                              <div class="col-sm-12">
                                <label>Date:</label>
                                <div class="input-group date form_date " data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                  <input class="form-control" size="16" type="text" id="searchBegin" value="" readonly>
                                  <span class="input-group-addon">
                                          <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                                </div>
                                <label> &nbsp;to&nbsp; </label>
                                <div class="input-group date form_date " data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                                  <input class="form-control" size="16" type="text" id="searchEnd" value="" readonly>
                                  <span class="input-group-addon">
                                          <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                                </div>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <label>Time:</label>
                                <div class="form-group">
                                  <input type="tel" class="form-control hour" id="fromHour" placeholder="0" style="width:40px">
                                </div>
                                <label> &nbsp;to&nbsp; </label>
                                <div class="form-group">
                                  <input type="tel" class="form-control hour" id="toHour" placeholder="24" style="width:40px">
                                </div>
                                <button type="button" class="btn btn-link" title="Add" onclick="">
                                  <div class="title"><i class="fa fa-check fa-2x"></i></div>
                                </button>
                              </div>
                            </form>
                          </div>
                        </div>
                        <div class="panel fresh-color panel-info">
                          <div class="panel-heading">Time Scope Editing List</div>
                          <div class="panel-body">
                            <table class="table table-striped sortable" cellspacing="0" width="100%">
                              <thead>
                                <tr>
                                  <th>atomic name</th>
                                  <th>date scope logic </th>
                                  <th>time scope logic </th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td data-bind="text: 'atomic name'"></td>
                                  <td data-bind="text: 'from 2016-01-01 to 2017-12-31'"></td>
                                  <td data-bind="text: 'from 6:00 to 18:00'"></td>
                                </tr>
                                <tr>
                                  <td data-bind="text: 'atomic name'"></td>
                                  <td data-bind="text: 'from 2016-01-01 to 2017-12-31'"></td>
                                  <td data-bind="text: 'from 6:00 to 18:00'"></td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="card card-info">
                    <div class="card-header">
                      <div class="card-title">
                        <div class="title"><i class="fa fa-cogs"></i> Business Condition Editing </div>
                      </div>
                      <div class="pull-right card-action">
                        <div class="btn-group" role="group" aria-label="..." id="hideConditionTimeDIV" style="display:none">
                          <button type="button" class="btn btn-link" title="隐藏" onclick="$('#conditionContentDIV').css('display', 'none'),$('#displayConditionTimeDIV').css('display', ''),$('#hideConditionTimeDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-up fa-2x"></i></div>
                          </button>
                        </div>
                        <div class="btn-group" role="group" aria-label="..." id="displayConditionTimeDIV">
                          <button type="button" class="btn btn-link" title="显示" onclick="$('#conditionContentDIV').css('display', ''),$('#hideConditionTimeDIV').css('display', ''),$('#displayConditionTimeDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-down fa-2x"></i></div>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="card profile" id="conditionContentDIV" style="display:none">
                      <div class="card-body">
                        <div class="panel fresh-color panel-info">
                          <div class="panel-heading">Business Condition Editing List</div>
                          <div class="panel-body">
                            123
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="card card-info">
                    <div class="card-header">
                      <div class="card-title">
                        <div class="title"><i class="fa fa-cogs"></i> Noise Editing </div>
                      </div>
                      <div class="pull-right card-action">
                        <div class="btn-group" role="group" aria-label="..." id="hideNoiseTimeDIV" style="display:none">
                          <button type="button" class="btn btn-link" title="隐藏" onclick="$('#NoiseContentDIV').css('display', 'none'),$('#displayNoiseTimeDIV').css('display', ''),$('#hideNoiseTimeDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-up fa-2x"></i></div>
                          </button>
                        </div>
                        <div class="btn-group" role="group" aria-label="..." id="displayNoiseTimeDIV">
                          <button type="button" class="btn btn-link" title="显示" onclick="$('#NoiseContentDIV').css('display', ''),$('#hideNoiseTimeDIV').css('display', ''),$('#displayNoiseTimeDIV').css('display', 'none')">
                            <div class="title"><i class="fa fa-sort-down fa-2x"></i></div>
                          </button>
                        </div>
                      </div>
                    </div>
                    <div class="card profile" id="NoiseContentDIV" style="display:none">
                      <div class="card-body">
                        <div class="panel fresh-color panel-info">
                          <div class="panel-heading">Noise Editing List</div>
                          <div class="panel-body">
                            123
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>










          </div>
          <!-- *******YOUR SHOULD CODING IN HERE:[END]*******-->
        </div>
      </div>
    </div>
  </div>
  <!--CONTENT DIV END-->
</div>

<script>
  // Initialize the View Model
  // Clean the paging binding nodes
  // Binding the view Model
  var genericModalViewModel = new GenericModalViewModel();
  ko.cleanNode($('#genericModalDiv')[0]);
  ko.applyBindings(genericModalViewModel, document.getElementById('genericModalDiv'));
</script>

<script>
  // Setup the business model with view model
  (function initialize() {
    // *******YOUR SHOULD CODING IN HERE:*******
    function BusinessPOJO() {
      var self = this;
      self.availableMetadatas = ko.observableArray([]);
      self.selectedMetadata = ko.observable();
      self.availableAtomics = ko.observableArray([]);
      self.tables = new ListViewModel();
      self.atomics = new ListViewModel();

    }
    var businessPOJO = new BusinessPOJO();
    genericModalViewModel.businessPOJO(businessPOJO);
  })();

  function execute() {
    // validation failed
    // show validation error message in the warning DIV...
    if (!genericModalViewModel.validation(businessValidation)) {
      return;
    } else {
      // validation correct
      // do your business...
      runService();
    }
  }

  // *******YOUR SHOULD CODING IN HERE:*******
  var businessValidation = function() {
    var errorMessages = [];
    //validate logic...

    return errorMessages;
  }

  // *******YOUR SHOULD CODING IN HERE:*******
  var runService = function() {

  }
</script>

<script>
  var retrieveData_mock = function() {
    $.ajax({
      url: $.getRootPath() + "/assets/self-owned/data/mock_metadata_table_list.json",
      type: 'GET',
      dataType: 'json',
      success: function(json) {
        var serverData = json;
        var tableData = DataTransferPOJO.serverJsonData2TableData(serverData);
        genericModalViewModel.businessPOJO().tables.buildData(tableData.result);
        genericModalViewModel.businessPOJO().tables.columnNames(tableData.header);
        genericModalViewModel.businessPOJO().tables.buildView();
      },
      error: function(xhr, status) {
        console.log('Sorry, there was a problem on SERVER_REQUEST_ACTION process!');
      },
      complete: function(xhr, status) {}
    });
    $.ajax({
      url: $.getRootPath() + "/assets/self-owned/data/mock_metadata_atomic_list.json",
      type: 'GET',
      dataType: 'json',
      success: function(json) {
        var serverData = json;
        var tableData = DataTransferPOJO.serverJsonData2TableData(serverData);
        genericModalViewModel.businessPOJO().atomics.buildData(tableData.result);
        genericModalViewModel.businessPOJO().atomics.columnNames(tableData.header);
        genericModalViewModel.businessPOJO().atomics.buildView();
      },
      error: function(xhr, status) {
        console.log('Sorry, there was a problem on SERVER_REQUEST_ACTION process!');
      },
      complete: function(xhr, status) {}
    });
  }
  retrieveData_mock();
</script>
