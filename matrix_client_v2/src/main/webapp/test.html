<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="The Matrix Components Framework">
  <meta name="author" content="LY">
  <title>Matrix</title>
  <link rel="shortcut icon" href="assets/self-owned/ico/favicon.png">
  <link rel="stylesheet" type="text/css" href="assets/reference/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="assets/reference/flat-ui/css/flat-ui.css">
  <link rel="stylesheet" type="text/css" href="assets/reference/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="assets/self-owned/css/matrix.css">
  <link rel="stylesheet" type="text/css" href="assets/reference/bootstrap-fileinput/css/fileinput.min.css" media="all">


</head>

<body>
  <div class="flat-matrix" style="margin-top:-58px;">

  <!-- <div class="flat-matrix" style="background-image: url(assets/self-owned/img/mobile_background_1.jpg);background-repeat: no-repeat;background-size:100% 100%;margin-top:-58px;"> -->
    <div class="app-container">
      <div class="row content-container">
        <!-- 应用左侧NAV导航，可以应用与assist，帮助，过滤等辅助组件，默认自动收缩扩展，支持悬停（点击右上角按钮切换）-->
        <div class="container">
          <div>

            <div class="row">

              <!-- logo of the pingan -->
              <div style="margin-top:58px;">&nbsp;</div>
              <div>
                <img id="system_logo" class="img-responsive" src="assets/self-owned/img/f_easy.svg" alt="" style="width:30%;display: block;position: relative;margin: auto;">
              </div>
              <!-- title: such lik kaimenhong -->
              <br>
              <br>
              <br>

              <!-- <div class="row">
                <div class="col-xs-10 col-xs-offset-1 text-center">
                  <img id="logoIMG" src="assets/self-owned/img/xinyuanka1.jpg" class="img-thumbnail" alt="500x500" style="width: 380px; height: 160px;">
                </div>
                <div class="col-xs-6 text-right">
                  <img id="logoIMG" src="assets/self-owned/img/xinyuanka1.jpg" class="img-thumbnail" alt="500x500" style="width: 160px; height: 160px;">
                </div>
                <div class="col-xs-6 text-left">
                  <img id="logoIMG" src="assets/self-owned/img/xinyuanka1.jpg" class="img-thumbnail" alt="500x500" style="width: 160px; height: 160px;">
                </div>
              </div> -->


              <div id="matrix_upload_div">
                <div class="row">
                  <div class="col-md-12">
                    <div>
                      <div class="alert fresh-color " data-bind="css:alerts.styleClass,visible:alerts.resultVisible">
                        <button type="button" class="close" data-bind="click:alerts.resultVisible(false)" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <strong>
                            <span data-bind="text:alerts.resultTitle"></span>
                          </strong>
                        <span data-bind="text:alerts.resultSubTitle"></span>
                        <div data-bind="text:alerts.resultContent"></div>
                      </div>
                    </div>
                  </div>
                </div>
                <br>
                <div class="row">
                  <div data-bind="foreach:t">
                    <!-- <div class="col-xs-6"> -->
                      <!-- <img data-bind="attr:{src:$data}" class="img-thumbnail"> -->
                      <!-- <img src="http://localhost:41535/service_generic_query/matrix/upload/scripter/ops/notebook/uploadPageData/ops_1474514439999.jpg" class="img-thumbnail"> -->
                    <!-- </div> -->

                    1
                    <img src="http://localhost:41535/service_generic_query/matrix/upload/scripter/ops/notebook/uploadPageData/ops_1474514439999.jpg" class="img-thumbnail">
                  </div>

                </div>
                <br>

                <div class="row">
                  <div class="col-xs-12">
                    <form class="form-horizontal">
                      <div class="form-group">
                        <div class="col-sm-12">
                          <input id="input-id" type="file" name="file">
                        </div>
                      </div>
                    </form>
                  </div>
                </div>

              </div>

              <br>
              <br>
              <br>

              <!-- form div -->
              <div class="col-xs-12 text-center">
                <form class="form-horizontal">
                  <div class="form-group ">
                    <label class="col-xs-12 control-label">
                      <span style="font-weight: bold;font-size: 16px; text-align: center;color:white">I wish...</span>
                    </label>

                    <div class="col-xs-12 text-center" style="overflow: auto">
                      <textarea data-bind="value:inputContent,valueUpdate:'input'" rows="3" cols="32" placeholder="Please add comments here..."></textarea>
                    </div>
                  </div>
                </form>
                <div class="col-xs-12 text-center">
                  <a  class="btn btn-danger  btn-wide text-center" href="#" style="width:260px; color:white" onclick="'">Submit </a>
                </div>
                <br>
                <br>
                <br>
                <br>
                <br>
                <br>

                <div class="" style="color:white;font-size:11px">
                  <p><strong>Matrix</strong> is a development phase whole lifecycle solution, Support <strong>© 2016 Scripter Team</strong>. All rights reserved.</p>
                </div>
              </div>

            </div>

          </div>
        </div>

      </div>
    </div>
  </div>


  <script src="assets/reference/jquery/jquery-1.11.1.min.js"></script>
  <script src="assets/reference/jquery/jquery.json.js"></script>
  <script src="assets/reference/knockout.js/knockout-3.3.0.js"></script>
  <script src="assets/reference/jquery-tiny-pubsub/tiny-pubsub.js"></script>
  <script src="assets/reference/flat-ui/js/vendor/video.js"></script>
  <script src="assets/reference/flat-ui/js/flat-ui.min.js"></script>
  <script src="assets/reference/flat-ui/docs/assets/js/prettify.js"></script>
  <script src="assets/reference/flat-ui/docs/assets/js/application.js"></script>
  <script src="assets/reference/bootstrap-fileinput/js/fileinput.js"></script>
  <script src="assets/reference/bootstrap-fileinput/js/locales/zh.js"></script>
  <!-- Javascript for Matrix Self Owned -->
  <script src="assets/self-owned/js/generic/generic_algorithm.js"></script>
  <script src="assets/self-owned/js/generic/generic_cache.js"></script>
  <script src="assets/self-owned/js/generic/generic_charting.js"></script>
  <script src="assets/self-owned/js/generic/generic_csv.js"></script>
  <script src="assets/self-owned/js/generic/generic_cud.js"></script>
  <script src="assets/self-owned/js/generic/generic_modal.js"></script>
  <script src="assets/self-owned/js/generic/generic_prototype.js"></script>
  <script src="assets/self-owned/js/generic/generic_query.js"></script>
  <script src="assets/self-owned/js/generic/generic_table.js"></script>
  <script src="assets/self-owned/js/generic/generic_util.js"></script>
  <script src="assets/self-owned/js/generic/generic_validation.js"></script>
  <script src="assets/self-owned/js/generic/generic_upload.js"></script>

  <script>
    $(document).ready(function() {



    });
    function GenericUploadPageViewModel() {
      var self = this;
      self.uploadRef = null;
      self.key1 = ko.observable('ops');
      self.key2 = ko.observable('scripter');
      self.key3 = ko.observable('notebook');
      self.key4 = ko.observable('uploadPageData');
      self.alerts = new ResponseViewModel(); // This model is located in the generic_query.js
      self.uploadedFileUrls = ko.observableArray();
      self.t = ko.observableArray(["http://localhost:41535/service_generic_query/matrix/upload/scripter/ops/notebook/uploadPageData/ops_1474514439999.jpg","http://localhost:41535/service_generic_query/matrix/upload/scripter/ops/notebook/uploadPageData/ops_1474514439999.jpg"]);

      self.validation_before_upload = function(){
        if (self.key1() && self.key2() && self.key3() && self.key4()) {
          vm.alerts.resultVisible(false);
        } else {
          self.alerts.warningResponse("Validation Error", "Tips:", "[Upload File Validation]");
          if(self.uploadRef){
            uploadRef.fileinput('cancel');
            uploadRef.fileinput('clear');
          }
        }
      };

      self.upload_error_handler = function(){
        self.alerts.warningResponse(msg, "Tips:", "[Upload File Error]");
      }
    }

    var vm = new GenericUploadPageViewModel();
    ko.applyBindings(vm, document.getElementById('matrix_upload_div'));
    initialize_pic_upload_environment('input-id',vm);

    $.subscribe("SUCCESS_LISTENER", successListener);
    $.subscribe("FAILED_LISTENER", failedListener);

    function failedListener() {
      if (arguments && arguments[1]) {
        var errorMessage = arguments[1].errorMessage;
        vm.alerts.errorResponse(errorMessage, "Server Service Error!", "Please read the message below:");
      }
    }
    function successListener() {
      if (arguments && arguments[1]) {
        // vm.alerts.correctResponse("Return Upload Success Response", "Successed!", "Congratulations!");
        console.log("response context is:" + JSON.stringify(arguments[1]));

        var img_url_path = $.getServerRoot() + "/service_generic_query" + arguments[1].result[0].stringkappa;
        console.log(img_url_path);

        if (vm) {
          vm.uploadedFileUrls().push(img_url_path);
          vm.t().push(img_url_path);
        }
      }
    }
  </script>
</body>

</html>
